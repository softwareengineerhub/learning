Aggregation should be done as follows:

1) Average for mouse
2) Sum for TV
3) Average for music_service,
4) Max for video_service,
5) Min for phone.

To calculate week number for date use next code:
	
	private Date getWeekOfYear(Date date) {
        Calendar calendar = Calendar.getInstance();
        calendar.setTime(date);
        //int weekNumber = calendar.get(Calendar.WEEK_OF_YEAR);
        calendar.set(Calendar.DAY_OF_WEEK, 0);
        return calendar.getTime();
    }